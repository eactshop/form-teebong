<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>L√™n ƒê∆°n H√†ng</title>
  <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@700&family=DM+Sans:wght@300;400;500;600&display=swap" rel="stylesheet"/>
  <style>
    *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
    :root {
      --ink: #1a1a1a; --cream: #f8f4ef; --accent: #c9612a;
      --accent-light: #e8855a; --border: #d9cfc4; --shadow: rgba(50,30,10,0.12);
    }
    body {
      font-family: 'DM Sans', sans-serif; background: var(--cream);
      min-height: 100vh; display: flex; flex-direction: column;
      align-items: center; justify-content: flex-start; padding: 40px 20px 60px;
    }
    body::before {
      content: ''; position: fixed; inset: 0;
      background:
        radial-gradient(ellipse 80% 60% at 10% 20%, rgba(201,97,42,0.08) 0%, transparent 60%),
        radial-gradient(ellipse 60% 80% at 90% 80%, rgba(201,97,42,0.06) 0%, transparent 60%);
      pointer-events: none;
    }
    .card {
      background: #fff; border-radius: 4px; width: 100%; max-width: 560px;
      padding: 52px 48px 44px;
      box-shadow: 0 2px 0 var(--accent), 0 8px 40px var(--shadow), 0 1px 0 var(--border);
      position: relative; animation: fadeUp 0.6s ease both;
    }
    @keyframes fadeUp { from { opacity:0; transform:translateY(24px); } to { opacity:1; transform:translateY(0); } }
    .card::before {
      content: '‚ú¶'; position: absolute; top: 18px; right: 22px;
      font-size: 11px; color: var(--accent); opacity: 0.5; letter-spacing: 6px;
    }
    .header { margin-bottom: 32px; }
    .header-label {
      font-size: 11px; font-weight: 600; letter-spacing: 3px;
      text-transform: uppercase; color: var(--accent); margin-bottom: 10px; display: block;
    }
    .header h1 { font-family: 'Playfair Display', serif; font-size: 34px; color: var(--ink); line-height: 1.15; letter-spacing: -0.5px; }
    .header p { margin-top: 8px; font-size: 14px; color: #888; font-weight: 300; }
    .divider { width: 40px; height: 2px; background: var(--accent); margin: 14px 0 0; border-radius: 2px; }
    .form-group { margin-bottom: 22px; }
    label { display: block; font-size: 11px; font-weight: 600; letter-spacing: 1.5px; text-transform: uppercase; color: #777; margin-bottom: 7px; }
    label span { color: var(--accent); }
    input[type=text], input[type=tel], textarea {
      width: 100%; border: 1.5px solid var(--border); border-radius: 3px;
      padding: 12px 15px; font-family: 'DM Sans', sans-serif;
      font-size: 15px; color: var(--ink); background: var(--cream);
      transition: border-color 0.2s, background 0.2s, box-shadow 0.2s;
      outline: none; appearance: none;
    }
    input::placeholder, textarea::placeholder { color: #bbb; font-weight: 300; }
    input:focus, textarea:focus { border-color: var(--accent); background: #fff; box-shadow: 0 0 0 3px rgba(201,97,42,0.1); }
    textarea { resize: vertical; min-height: 88px; }
    .row { display: grid; grid-template-columns: 1fr 1fr; gap: 16px; }
    .btn {
      width: 100%; margin-top: 8px; padding: 15px 24px;
      background: var(--accent); color: #fff; border: none; border-radius: 3px;
      font-family: 'DM Sans', sans-serif; font-size: 14px; font-weight: 600;
      letter-spacing: 2px; text-transform: uppercase; cursor: pointer;
      transition: background 0.2s, transform 0.15s, box-shadow 0.2s;
      display: flex; align-items: center; justify-content: center; gap: 10px;
      position: relative; overflow: hidden;
    }
    .btn:hover:not(:disabled) { background: var(--accent-light); box-shadow: 0 4px 20px rgba(201,97,42,0.3); transform: translateY(-1px); }
    .btn:active { transform: translateY(0); }
    .btn:disabled { opacity: 0.65; cursor: not-allowed; }
    .spinner {
      width: 16px; height: 16px; border: 2px solid rgba(255,255,255,0.4);
      border-top-color: #fff; border-radius: 50%; animation: spin 0.7s linear infinite; display: none;
    }
    @keyframes spin { to { transform: rotate(360deg); } }
    .btn.loading .spinner { display: block; }
    .btn.loading .btn-text { opacity: 0.75; }
    .msg {
      display: none; text-align: center; padding: 14px 18px; border-radius: 3px;
      font-size: 14px; font-weight: 500; margin-top: 14px; animation: fadeUp 0.4s ease;
    }
    .msg.show { display: block; }
    .msg.success { background: #f0faf0; border: 1.5px solid #a8d5a2; color: #2e6e29; }
    .msg.error   { background: #fff4f4; border: 1.5px solid #f0a8a8; color: #9a2020; }
    .footer-note { text-align: center; font-size: 12px; color: #bbb; margin-top: 24px; font-weight: 300; }
    @media (max-width: 580px) {
      .card { padding: 36px 22px 32px; }
      .header h1 { font-size: 28px; }
      .row { grid-template-columns: 1fr; }
    }
  </style>
</head>
<body>

<div class="card">
  <div class="header">
    <span class="header-label">‚ú¶ ƒê·∫∑t h√†ng</span>
    <h1>L√™n ƒê∆°n H√†ng</h1>
    <p>ƒêi·ªÅn th√¥ng tin b√™n d∆∞·ªõi ƒë·ªÉ ti·∫øn h√†nh ƒë·∫∑t h√†ng</p>
    <div class="divider"></div>
  </div>

  <form id="orderForm" novalidate>
    <div class="form-group">
      <label>H·ªç v√† t√™n <span>*</span></label>
      <input type="text" name="fullname" placeholder="Nguy·ªÖn VƒÉn A" required />
    </div>

    <div class="form-group">
      <label>S·ªë ƒëi·ªán tho·∫°i <span>*</span></label>
      <input type="tel" name="phone" placeholder="0912 345 678" required />
    </div>

    <div class="form-group">
      <label>ƒê·ªãa ch·ªâ giao h√†ng <span>*</span></label>
      <textarea name="address" placeholder="S·ªë nh√†, ƒë∆∞·ªùng, ph∆∞·ªùng/x√£, qu·∫≠n/huy·ªán, t·ªânh/th√†nh..." required></textarea>
    </div>

    <div class="row">
      <div class="form-group">
        <label>S·∫£n ph·∫©m <span>*</span></label>
        <input type="text" name="product" placeholder="T√™n s·∫£n ph·∫©m" required />
      </div>
      <div class="form-group">
        <label>Gi√° (VNƒê) <span>*</span></label>
        <input type="text" name="price" placeholder="250,000" required />
      </div>
    </div>

    <div class="form-group">
      <label>C√¢n n·∫∑ng (kg) <span>*</span></label>
      <input type="text" name="weight" placeholder="VD: 5.2" required />
    </div>

    <div class="row">
      <div class="form-group">
        <label>COD (VNƒê) <span>*</span></label>
        <input type="text" name="cod" placeholder="154,000" required />
      </div>
      <div class="form-group">
        <label>Ph√≠ ship (VNƒê) <span>*</span></label>
        <input type="text" name="shipfee" placeholder="20,000" required />
      </div>
    </div>

    <button type="submit" class="btn" id="submitBtn">
      <span class="spinner"></span>
      <span class="btn-text">‚Üí X√°c nh·∫≠n ƒë∆°n h√†ng</span>
    </button>
  </form>

  <div class="msg success" id="successMsg">üéâ ƒê∆°n h√†ng ƒë√£ ƒë∆∞·ª£c ghi nh·∫≠n th√†nh c√¥ng! Ch√∫ng t√¥i s·∫Ω li√™n h·ªá s·ªõm nh·∫•t.</div>
  <div class="msg error" id="errorMsg"></div>

  <p class="footer-note">Th√¥ng tin c·ªßa b·∫°n ƒë∆∞·ª£c b·∫£o m·∫≠t tuy·ªát ƒë·ªëi</p>
</div>

<script>
  const SHEET_URL = 'https://script.google.com/macros/s/AKfycbx8Fvul32H3dBoubd0Yt8m_pV0E8R82QhVp7qfjHmFI1ROO6JHuzSbnF0Xrqh7kCkc/exec';

  // Format s·ªë t·ª± ƒë·ªông
  ['price', 'cod', 'shipfee'].forEach(function(name) {
    document.querySelector('input[name="' + name + '"]').addEventListener('input', function() {
      var v = this.value.replace(/\D/g, '');
      this.value = v ? Number(v).toLocaleString('vi-VN') : '';
    });
  });

  function showMsg(id, text, duration) {
    ['successMsg','errorMsg'].forEach(function(x) { document.getElementById(x).classList.remove('show'); });
    var el = document.getElementById(id);
    el.textContent = text;
    el.classList.add('show');
    if (duration !== 0) { setTimeout(function() { el.classList.remove('show'); }, duration || 6000); }
  }

  document.getElementById('orderForm').addEventListener('submit', async function(e) {
    e.preventDefault();

    var fields = this.querySelectorAll('[required]');
    var valid = true;
    fields.forEach(function(f) {
      f.style.borderColor = '';
      if (!f.value.trim()) { f.style.borderColor = '#e55'; valid = false; }
    });
    if (!valid) { showMsg('errorMsg', '‚ö†Ô∏è Vui l√≤ng ƒëi·ªÅn ƒë·∫ßy ƒë·ªß th√¥ng tin b·∫Øt bu·ªôc.'); return; }

    var btn = document.getElementById('submitBtn');
    btn.classList.add('loading');
    btn.disabled = true;

    var payload = {
      fullname: this.fullname.value.trim(),
      phone:    "'" + this.phone.value.trim(),
      address:  this.address.value.trim(),
      product:  this.product.value.trim(),
      price:    this.price.value.trim(),
      weight:   this.weight.value.trim(),
      cod:      this.cod.value.trim(),
      shipfee:  this.shipfee.value.trim(),
    };

    try {
      await fetch(SHEET_URL, {
        method: 'POST',
        mode: 'no-cors',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify(payload),
      });
      this.reset();
      showMsg('successMsg', 'üéâ ƒê∆°n h√†ng ƒë√£ ƒë∆∞·ª£c ghi nh·∫≠n th√†nh c√¥ng! Ch√∫ng t√¥i s·∫Ω li√™n h·ªá s·ªõm nh·∫•t.');
    } catch (err) {
      showMsg('errorMsg', '‚ùå G·ª≠i th·∫•t b·∫°i: ' + err.message);
    } finally {
      btn.classList.remove('loading');
      btn.disabled = false;
    }
  });
</script>
</body>
</html>